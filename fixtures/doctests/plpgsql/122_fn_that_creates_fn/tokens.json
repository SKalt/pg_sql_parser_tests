[
  {
    "Name": "CREATE",
    "Start": 0,
    "End": 6,
    "Text": "CREATE"
  },
  {
    "Name": "OR",
    "Start": 7,
    "End": 9,
    "Text": "OR"
  },
  {
    "Name": "REPLACE",
    "Start": 10,
    "End": 17,
    "Text": "REPLACE"
  },
  {
    "Name": "PROCEDURE",
    "Start": 18,
    "End": 27,
    "Text": "PROCEDURE"
  },
  {
    "Name": "IDENT",
    "Start": 28,
    "End": 56,
    "Text": "cs_update_referrer_type_proc"
  },
  {
    "Name": "ASCII_40",
    "Start": 56,
    "End": 57,
    "Text": "("
  },
  {
    "Name": "ASCII_41",
    "Start": 57,
    "End": 58,
    "Text": ")"
  },
  {
    "Name": "AS",
    "Start": 59,
    "End": 61,
    "Text": "AS"
  },
  {
    "Name": "SCONST",
    "Start": 62,
    "End": 956,
    "Text": "$func$\nDECLARE\n    referrer_keys CURSOR IS\n        SELECT * FROM cs_referrer_keys\n        ORDER BY try_order;\n    func_body text;\n    func_cmd text;\nBEGIN\n    func_body := 'BEGIN';\n\n    FOR referrer_key IN referrer_keys LOOP\n        func_body := func_body ||\n          ' IF v_' || referrer_key.kind\n          || ' LIKE ' || quote_literal(referrer_key.key_string)\n          || ' THEN RETURN ' || quote_literal(referrer_key.referrer_type)\n          || '; END IF;' ;\n    END LOOP;\n\n    func_body := func_body || ' RETURN NULL; END;';\n\n    func_cmd :=\n      'CREATE OR REPLACE FUNCTION cs_find_referrer_type(v_host varchar,\n                                                        v_domain varchar,\n                                                        v_url varchar)\n        RETURNS varchar AS '\n      || quote_literal(func_body)\n      || ' LANGUAGE plpgsql;' ;\n\n    EXECUTE func_cmd;\nEND;\n$func$"
  },
  {
    "Name": "LANGUAGE",
    "Start": 957,
    "End": 965,
    "Text": "LANGUAGE"
  },
  {
    "Name": "IDENT",
    "Start": 966,
    "End": 973,
    "Text": "plpgsql"
  },
  {
    "Name": "ASCII_59",
    "Start": 973,
    "End": 974,
    "Text": ";"
  }
]